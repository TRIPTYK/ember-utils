{"version":3,"file":"ensure-model-properties.js","sources":["../../src/utils/ensure-model-properties.ts"],"sourcesContent":["import type Model from '@ember-data/model';\nimport type { UnwrapComputedPropertyGetter } from '@ember/object/-private/types';\nimport type { Merge, SetRequired, TupleToUnion } from 'type-fest';\n\nexport type LoadedModel<T extends Model, P extends (keyof T)[]> = Merge<\n  SetRequired<T, TupleToUnion<P>>,\n  {\n    get<K extends keyof SetRequired<T, TupleToUnion<P>>>(\n      key: K,\n    ): UnwrapComputedPropertyGetter<SetRequired<T, TupleToUnion<P>>[K]>;\n  }\n>;\n\nexport default function ensureModelProperties<\n  T extends Model,\n  C extends typeof Model,\n  P extends (keyof T)[],\n>(model: T, modelConstructor: C, properties: P): LoadedModel<T, P> {\n  modelConstructor.eachAttribute((name) => {\n    if (\n      properties.includes(name.toString() as keyof T) &&\n      model[name.toString() as keyof T] === undefined\n    ) {\n      throw new Error(\n        `Missing ${\n          modelConstructor.modelName\n        } attribute property in model: ${name.toString()} (value: undefined)`,\n      );\n    }\n  });\n  modelConstructor.eachRelationship((name: string, meta) => {\n    if (properties.includes(name.toString() as keyof T)) {\n      const reference = model[meta.kind](meta.name as never);\n      if (reference.value() === null) {\n        throw new Error(\n          `Missing ${\n            modelConstructor.modelName\n          } relationship property in model: ${name.toString()}`,\n        );\n      }\n    }\n  });\n  return model as unknown as LoadedModel<T, P>;\n}\n"],"names":["ensureModelProperties","model","modelConstructor","properties","eachAttribute","name","includes","toString","undefined","Error","modelName","eachRelationship","meta","reference","kind","value"],"mappings":"AAae,SAASA,qBAAqBA,CAI3CC,KAAQ,EAAEC,gBAAmB,EAAEC,UAAa,EAAqB;AACjED,EAAAA,gBAAgB,CAACE,aAAa,CAAEC,IAAI,IAAK;IACvC,IACEF,UAAU,CAACG,QAAQ,CAACD,IAAI,CAACE,QAAQ,EAAa,CAAC,IAC/CN,KAAK,CAACI,IAAI,CAACE,QAAQ,EAAE,CAAY,KAAKC,SAAS,EAC/C;AACA,MAAA,MAAM,IAAIC,KAAK,CACZ,CAAA,QAAA,EACCP,gBAAgB,CAACQ,SAClB,CAAgCL,8BAAAA,EAAAA,IAAI,CAACE,QAAQ,EAAG,qBACnD,CAAC,CAAA;AACH,KAAA;AACF,GAAC,CAAC,CAAA;AACFL,EAAAA,gBAAgB,CAACS,gBAAgB,CAAC,CAACN,IAAY,EAAEO,IAAI,KAAK;IACxD,IAAIT,UAAU,CAACG,QAAQ,CAACD,IAAI,CAACE,QAAQ,EAAa,CAAC,EAAE;AACnD,MAAA,MAAMM,SAAS,GAAGZ,KAAK,CAACW,IAAI,CAACE,IAAI,CAAC,CAACF,IAAI,CAACP,IAAa,CAAC,CAAA;AACtD,MAAA,IAAIQ,SAAS,CAACE,KAAK,EAAE,KAAK,IAAI,EAAE;AAC9B,QAAA,MAAM,IAAIN,KAAK,CACZ,CAAA,QAAA,EACCP,gBAAgB,CAACQ,SAClB,CAAmCL,iCAAAA,EAAAA,IAAI,CAACE,QAAQ,EAAG,EACtD,CAAC,CAAA;AACH,OAAA;AACF,KAAA;AACF,GAAC,CAAC,CAAA;AACF,EAAA,OAAON,KAAK,CAAA;AACd;;;;"}