{"version":3,"file":"download-file.js","sources":["../../src/services/download-file.ts"],"sourcesContent":["import Service from '@ember/service';\nimport type Adapter from '@ember-data/adapter/rest';\nimport type { OptionalParams } from 'js-file-downloader';\nimport config from 'ember-get-config';\nimport JsFileDownloader from 'js-file-downloader';\nimport getAdapterOrThrow from '../utils/get-adapter-or-throw';\n\ninterface DownloadFileParameters {\n  path: string;\n  filename: string;\n}\n\nexport interface DownloadFileService {\n  downloadFile(\n    file: DownloadFileParameters,\n    options?: OptionalParams,\n  ): Promise<void>;\n}\n\nexport default class DownloadFileServiceImpl\n  extends Service\n  implements DownloadFileService\n{\n  private adapter: Adapter;\n\n  public constructor(props?: object) {\n    super(props);\n    this.adapter = getAdapterOrThrow(this);\n  }\n\n  async downloadFile(file: DownloadFileParameters, options: OptionalParams) {\n    if (config.environment === 'test') return;\n\n    return new JsFileDownloader({\n      ...options,\n      url: `${this.adapter.host}/${file.path}`,\n      filename: `${file.filename}`,\n      headers: [\n        {\n          name: 'Authorization',\n          value:\n            (this.adapter.headers as Record<string, string>)['Authorization'] ??\n            '',\n        },\n      ],\n    });\n  }\n}\n\ndeclare module '@ember/service' {\n  interface Registry {\n    'download-file': DownloadFileServiceImpl;\n  }\n}\n"],"names":["DownloadFileServiceImpl","Service","constructor","props","_defineProperty","adapter","getAdapterOrThrow","downloadFile","file","options","config","environment","JsFileDownloader","url","host","path","filename","headers","name","value"],"mappings":";;;;;;AAmBe,MAAMA,uBAAuB,SAClCC,OAAO,CAEjB;EAGSC,WAAWA,CAACC,KAAc,EAAE;IACjC,KAAK,CAACA,KAAK,CAAC,CAAA;IAACC,eAAA,CAAA,IAAA,EAAA,SAAA,EAAA,KAAA,CAAA,CAAA,CAAA;AACb,IAAA,IAAI,CAACC,OAAO,GAAGC,iBAAiB,CAAC,IAAI,CAAC,CAAA;AACxC,GAAA;AAEA,EAAA,MAAMC,YAAYA,CAACC,IAA4B,EAAEC,OAAuB,EAAE;AACxE,IAAA,IAAIC,MAAM,CAACC,WAAW,KAAK,MAAM,EAAE,OAAA;IAEnC,OAAO,IAAIC,gBAAgB,CAAC;AAC1B,MAAA,GAAGH,OAAO;MACVI,GAAG,EAAG,CAAE,EAAA,IAAI,CAACR,OAAO,CAACS,IAAK,CAAGN,CAAAA,EAAAA,IAAI,CAACO,IAAK,CAAC,CAAA;AACxCC,MAAAA,QAAQ,EAAG,CAAA,EAAER,IAAI,CAACQ,QAAS,CAAC,CAAA;AAC5BC,MAAAA,OAAO,EAAE,CACP;AACEC,QAAAA,IAAI,EAAE,eAAe;QACrBC,KAAK,EACF,IAAI,CAACd,OAAO,CAACY,OAAO,CAA4B,eAAe,CAAC,IACjE,EAAA;OACH,CAAA;AAEL,KAAC,CAAC,CAAA;AACJ,GAAA;AACF;;;;"}